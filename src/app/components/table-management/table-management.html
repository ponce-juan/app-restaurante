<div class="side-menu ">
    <div class="side-menu-header">
         <div class="d-flex">
            <input 
                class="form-control" 
                type="search" 
                name="search" 
                id="search" 
                placeholder="Search..."
                [(ngModel)]="searchText"
                (change)="filterProductList()">
        </div>
    </div>
    <div class="side-menu-body">
        <!-- Vista para cargar productos -->
        @if(showProducts()){
            @if(products() && products().length > 0){
                <div class="table-list ">
                    <table class="table table-striped">
                    <thead>
                        <tr>
                        <th>Nombre</th>
                        <th>Categor√≠a</th>
                        <th>Subcategor√≠a</th>
                        <th>Precio</th>
                        <th>Stock</th>
                        </tr>
                    </thead>
                    <tbody>
                        @for(product of products(); track $index){
                            <tr 
                                class="align-middle"
                                [class.table-danger]="product.stock <= 0" 
                                [attr.disabled]="product.stock <= 0" 
                                (click)="selectProduct(product)"
                                [class.table-success]="product === selectedProduct">
                            <td>{{ product.name }}</td>
                            <td>{{ product.category.name }}</td>
                            <td>{{ product.subCategory.name }}</td>
                            <td>{{ product.price }}</td>
                            <td>{{ product.stock }}</td>
                            </tr>
                        }
                    </tbody>
                    </table>
                </div>
            }@else{
                <h3 class="text-center">No hay productos para mostrar.</h3>
            }
        }
        <!-- Vista para ver/modificar orden de productos -->
        @if(showOrder()){
            <div class="table-list">
                <table class="table table-striped">
                <thead>
                    <tr>
                    <th>Nombre</th>
                    <th>Cantidad</th>
                    <th>Precio</th>
                    <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    @if(table() && table()?.order){
                        @for(item of table()!.order?.items; track $index){
                            <tr class="align-middle ">
                                <td>{{ item.name }}</td>
                                <td>{{ item.quantity }}</td>
                                <td>{{ item.price }}</td>
                                <td>
                                    <button type="button" class="btn btn-generic" (click)="editItemFromOrder(item)">‚úèÔ∏è</button>
                                    <button type="button" class="btn btn-generic text-danger fw-bold fs-5" (click)="removeItemFromOrder(item)">‚ùå</button>
                                </td>
                            </tr>
                        }
                        <tr class="fw-bold">
                            <td colspan="2" class="text-end">Total:</td>
                            <td>{{ table()!.order?.total }}</td>
                            <td></td>
                        </tr>

                    }
                </tbody>
                </table>
            </div>
        }
        @if(editItemMenu()){
        <div class="edit-item-menu d-flex flex-column justify-content-center gap-2" [class.open]="editItemMenu()">
            <div class="edit-item-header">
                <h5 class="text-center">Nueva cantidad</h5>
            </div>
            <div class="edit-item-body d-flex flex-row gap-2 justify-content-center">
                <input
                class="form-control w-25" 
                type="number" 
                name="quantity" id="quantity" min="1" 
                placeholder="Cantidad" 
                value="{{ itemToEdit().quantity }}"
                #quantityInput>

                <button class="btn btn-outline-success" (click)="saveItemChanges(quantityInput.valueAsNumber)">‚úÖ</button>
                <button class="btn btn-outline-danger fw-bold fs-5" (click)="closeEditMenu()">‚ùå</button>
            </div>
        </div>
    }
    </div>
    
    <div class="side-menu-footer justify-content-around">
        @if(showProducts()){
            <div class="d-flex flex-row gap-2">
                <input 
                    #quantity 
                    class="form-control" 
                    type="number" name="quantity" id="quantity" 
                    placeholder="Cantidad" min="0" step="1">
                <button 
                    class="btn btn-outline-success m-0" 
                    (click)="addItem(quantity.valueAsNumber)"
                    >Agregar producto
                </button>
            </div>
        }
        <button type="button" class="btn btn-outline-dark" (click)="printCheck()">üñ®Ô∏è Print ticket</button>
        <button type="button" class="btn btn-outline-dark" (click)="onCloseMenu()">Volver</button>

    </div>
</div>

    