<!-- <hr>
<div class="container mt-2"> -->
    <!-- HEADER -->
    <!-- <div class="d-flex flex-row justify-content-between align-items-center">
        <div class="col-4 col-md-4 mb-3">
          <label class="form-label m-0">Tipo de orden</label>
          <select class="form-select" name="orderType">
              @for(t of this.orderTypes(); track $index){
                <option value="{{t.type}}">{{t.type}}</option>
              }
          </select>
        </div>
        <button type="button" class="btn btn-success h-25" (click)="saveOrder()"
            >Guardar Orden
        </button>

    </div> -->

  <!-- LISTA DE PRODUCTOS -->
  <!-- <label class="form-label">Seleccionar producto</label>
  <table class="table table-hover table-sm ">
    <thead class="table-dark">
      <tr>
        <th>Nombre</th>
        <th>Precio</th>
        <th>Stock</th>
        <th>Categoría</th>
      </tr>
    </thead>
    <tbody>
        @if(loading()){
            <tr><td colspan="4">Cargando productos...</td></tr>
        }
        @if(errormsg()){
            <tr><td colspan="4">{{errormsg()}}</td></tr>
        }
        @if(!loading() && !errormsg()){
            @for(p of this.productService.products(); track $index){
                <tr (click)="onSelectProduct(p)" 
                    [class.table-active.table-success]="selectedProduct?.id === p.id"
                    [class.table-danger]="p.stock === 0"
                    data-bs-toggle="modal"
                    data-bs-target="#quantityModal"
                    >
                  <td>{{ p.name }}</td>
                  <td>$ {{ p.price }}</td>
                  <td>{{ p.stock }}</td>
                  <td>{{ p.category }}</td>
                </tr>
            }
        }
    </tbody>
  </table> -->
<!-- =========================== -->
<!-- MODAL PARA AGREGAR CANTIDAD -->
<!-- =========================== -->
<!-- <div class="modal fade" id="quantityModal" tabindex="-1" aria-labelledby="quantityModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header bg-dark text-white">
        <h5 class="modal-title">Agregar producto</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <p class="fw-bold m-0">{{selectedProduct?.name}}</p>
        <p class="text-muted m-0">Precio: ${{selectedProduct?.price}}</p>
        <p class="text-muted">Stock disponible: {{selectedProduct?.stock}}</p>

        <label class="form-label">Cantidad</label>
        <input type="number" min="1" class="form-control" formControlName="quantity">
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button class="btn btn-primary" (click)="confirmAddProductToOrder()">Cargar producto</button>
      </div>

    </div>
  </div>
</div> -->


<hr>
<div class="container mt-2">
    <!-- HEADER -->
    <div class="d-flex flex-row justify-content-between align-items-center">
        <div class="col-4 col-md-4 mb-3">
          <label class="form-label m-0">Tipo de orden</label>
          <select class="form-select" name="orderType">
              @for(t of this.orderTypes(); track $index){
                <option value="{{t.type}}">{{t.type}}</option>
              }
          </select>
        </div>
        <button type="button" class="btn btn-success h-25" (click)="saveOrder()">
            Guardar Orden
        </button>
    </div>

    <!-- LISTA DE PRODUCTOS -->
    <label class="form-label">Seleccionar producto</label>
    <table class="table table-hover table-sm ">
      <thead class="table-dark">
        <tr>
          <th>Nombre</th>
          <th>Precio</th>
          <th>Stock</th>
          <th>Categoría</th>
        </tr>
      </thead>
      <tbody>
          @if(loading()){
              <tr><td colspan="4">Cargando productos...</td></tr>
          }
          @if(errormsg()){
              <tr><td colspan="4">{{errormsg()}}</td></tr>
          }
          @if(!loading() && !errormsg()){
              @for(p of this.productService.products(); track $index){
                  <tr (click)="onSelectProduct(p)" 
                      [class.table-active.table-success]="selectedProduct?.id === p.id"
                      [class.table-danger]="p.stock === 0"
                      data-bs-toggle="modal"
                      data-bs-target="#quantityModal">
                    <td>{{ p.name }}</td>
                    <td>$ {{ p.price }}</td>
                    <td>{{ p.stock }}</td>
                    <td>{{ p.category }}</td>
                  </tr>
              }
          }
      </tbody>
    </table>

    <!-- =========================== -->
    <!-- MODAL PARA AGREGAR CANTIDAD -->
    <!-- =========================== -->
    <div class="modal fade" id="quantityModal" tabindex="-1" aria-labelledby="quantityModal" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">

          <div class="modal-header bg-dark text-white">
            <h5 class="modal-title">Agregar producto</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
          </div>

          <div class="modal-body" [formGroup]="itemForm">
            <p class="fw-bold m-0">{{selectedProduct?.name}}</p>
            <p class="text-muted m-0">Precio: ${{selectedProduct?.price}}</p>
            <p class="text-muted">Stock disponible: {{selectedProduct?.stock}}</p>

            <label class="form-label">Cantidad</label>
            <input type="number" min="1" class="form-control" formControlName="quantity">
          </div>

          <div class="modal-footer">
            <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button class="btn btn-primary" (click)="confirmAddProductToOrder()" data-bs-dismiss="modal">Cargar producto</button>
            <!-- <button class="btn btn-primary" (click)="confirmAddProductToOrder()">Cargar producto</button> -->
          </div>

        </div>
      </div>
    </div>

</div>
